import icalendar
import csv

def ics_vers_csv(fichier_entree, fichier_sortie):
    with open(fichier_entree, 'rb') as fichier_ics:
        calendrier = icalendar.Calendar.from_ical(fichier_ics.read())
        with open(fichier_sortie, 'w', newline='', encoding='utf-8') as fichier_csv:
            redacteur_csv = csv.writer(fichier_csv)
            redacteur_csv.writerow(['Heure de Debut', 'Heure de Fin', 'Resume', 'Lieu', 'Groupe'])  # Entêtes CSV
            for evenement in calendrier.walk('vevent'):
                debut = evenement.get('dtstart').dt.strftime('%Y-%m-%d %H:%M:%S')
                fin = evenement.get('dtend').dt.strftime('%Y-%m-%d %H:%M:%S')
                resume = evenement.get('summary')
                lieu = evenement.get('location')
                description = evenement.get('description')
                if description:
                    description = ' '.join(filter(lambda x: x.startswith(('RT', 'TD')), description.split()))
                else:
                    description = ''

                redacteur_csv.writerow([debut, fin, resume, lieu, description])

# Utilisation : Remplacez 'input.ics' par le nom de votre fichier ICS et 'output.csv' par le nom souhaité pour le fichier CSV.
ics_vers_csv('ADECal.ics', 'ORC.csv')
